<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel del Repartidor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>

<h1>ğŸš´ Panel del Repartidor</h1>

<div class="card" id="contenedorPedido">
Buscando pedidos disponibles...
</div>

<br>

<a href="../index.html">
  <button>Volver al inicio</button>
</a>

<script>
const pedido = JSON.parse(localStorage.getItem("pedido"));
const contenedor = document.getElementById("contenedorPedido");

if (!pedido || pedido.estado !== "en_reparto") {
  contenedor.innerHTML = "<p>No hay pedidos para retirar.</p>";
} else {

  let productosHTML = "";

  pedido.productos.forEach(prod => {
    productosHTML += `
      <p>${prod.nombre} x ${prod.cantidad} â€” $${prod.precio * prod.cantidad}</p>
    `;
  });

  contenedor.innerHTML = `
    <h3>ğŸ“ DirecciÃ³n de entrega</h3>
    <p>${pedido.direccion}</p>

    <hr>

    <h3>ğŸ›’ Pedido</h3>
    ${productosHTML}

    <hr>

    <h3>ğŸ’° Total: $${pedido.total}</h3>

    <br>

    <button onclick="tomarPedido()">Tomar pedido</button>
  `;
}

function tomarPedido() {
  let pedido = JSON.parse(localStorage.getItem("pedido"));
  pedido.estado = "en_camino";
  localStorage.setItem("pedido", JSON.stringify(pedido));
  window.location.href = "reparto_viaje.html";
}
</script>

</body>
</html>
