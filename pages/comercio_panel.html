<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel del Comercio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>

<h1>ğŸª Panel del Comercio</h1>

<div class="card" id="contenedorPedido">
Cargando pedido...
</div>

<br>

<a href="../index.html">
  <button>Volver al inicio</button>
</a>

<script>
const pedido = JSON.parse(localStorage.getItem("pedido"));
const contenedor = document.getElementById("contenedorPedido");

if (!pedido) {
  contenedor.innerHTML = "<p>No hay pedidos nuevos.</p>";
} else {

  let productosHTML = "";

  pedido.productos.forEach(prod => {
    productosHTML += `
      <p>${prod.nombre} x ${prod.cantidad} â€” $${prod.precio * prod.cantidad}</p>
    `;
  });

  contenedor.innerHTML = `
    <h3>ğŸ“ DirecciÃ³n</h3>
    <p>${pedido.direccion}</p>

    <hr>

    <h3>ğŸ›’ Productos</h3>
    ${productosHTML}

    <hr>

    <h3>ğŸ’° Total: $${pedido.total}</h3>

    <br>

    <button onclick="enviarRepartidor()">Enviar a repartidor</button>
  `;
}

function enviarRepartidor() {
  let pedido = JSON.parse(localStorage.getItem("pedido"));
  pedido.estado = "en_reparto";
  localStorage.setItem("pedido", JSON.stringify(pedido));
  alert("Pedido enviado al repartidor");
}
</script>

</body>
</html>
