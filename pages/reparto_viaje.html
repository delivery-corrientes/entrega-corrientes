<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Pedido en camino</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>

<h1>ğŸ›µ Pedido en camino</h1>

<div class="card" id="infoPedido">
Cargando datos del pedido...
</div>

<br>

<a href="../index.html">
  <button>Volver al inicio</button>
</a>

<script>
const pedido = JSON.parse(localStorage.getItem("pedido"));
const contenedor = document.getElementById("infoPedido");

if (!pedido || pedido.estado !== "en_camino") {
  contenedor.innerHTML = "<p>No hay entrega en curso.</p>";
} else {

  let productosHTML = "";

  pedido.productos.forEach(prod => {
    productosHTML += `
      <p>${prod.nombre} x ${prod.cantidad} â€” $${prod.precio * prod.cantidad}</p>
    `;
  });

  contenedor.innerHTML = `
    <h3>ğŸ“ DirecciÃ³n</h3>
    <p>${pedido.direccion}</p>

    <hr>

    <h3>ğŸ›’ Productos</h3>
    ${productosHTML}

    <hr>

    <h3>ğŸ’° Total: $${pedido.total}</h3>

    <br>

    <button onclick="entregado()">Marcar como entregado</button>
  `;
}

function entregado() {
  let pedido = JSON.parse(localStorage.getItem("pedido"));
  pedido.estado = "entregado";
  localStorage.setItem("pedido", JSON.stringify(pedido));
  window.location.href = "reparto_finalizado.html";
}
</script>

</body>
</html>
